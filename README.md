# Motion-In-betweening

![Example of motion in-betweening task, differentiating the given poses and the generated ones](media_readme/example_img.png "Motion in-betweening task.")

This repository contains the code for a 6-ECTS individual project as part of the [DD2465 Advanced, Individual Course in Computer Science](https://www.kth.se/student/kurser/kurs/DD2465?l=en) at KTH. The project was supervised by Rajmund Nagy, a third-year PhD student at KTH. You can find the final report [here](media_readme/Report_inbetweening_Silvia_Arellano_Garcia.pdf).

### Project Overview
The goal of this project was to develop a model capable of generating missing frames in a motion sequence, with variable gap sizes up to a maximum of 15 frames. Our model generates joint rotations and root positions separately:
1. **Joint rotations** using a diffusion model with a UNet architecture and Conv1D layers, conditioned on the reference frames' angles.
2. **Root positions** using an LSTM, conditioned on the root positions of the reference frames and the bone lengths.

Our approach produces smooth and realistic motion across a variety of actions.

### Motivation
This project aimed to:
- Gain hands-on experience implementing a diffusion model from scratch.
- Work with complex spatial and temporal data.
- Contribute to accelerating animation editing processes.

### Objectives
The key objectives were:
- Implement a deep-learning-based approach for motion in-betweening.
- Evaluate the model's performance qualitatively and quantitatively against baselines and related works.

### Results
Below are some examples comparing the motion generated by our model (15 missing central frames) with the original motion and interpolated motion:

#### Example 1: Running in a Straight Line
| **Our Model**    | **Reference**    | **Interpolation** |
|------------------|------------------|--------------------|
| <video width="200" controls> <source src="media_readme/our_model/35.mp4" type="video/mp4"> Your browser does not support the video tag. </video> | <video width="200" controls> <source src="media_readme/original/35.mp4" type="video/mp4"> Your browser does not support the video tag. </video> | <video width="200" controls> <source src="media_readme/interp/35.mp4" type="video/mp4"> Your browser does not support the video tag. </video> |

#### Example 2: Dancing
| **Our Model**    | **Reference**    | **Interpolation** |
|------------------|------------------|--------------------|
| <video width="200" controls> <source src="media_readme/our_model/773.mp4" type="video/mp4"> Your browser does not support the video tag. </video> | <video width="200" controls> <source src="media_readme/original/773.mp4" type="video/mp4"> Your browser does not support the video tag. </video> | <video width="200" controls> <source src="media_readme/interp/773.mp4" type="video/mp4"> Your browser does not support the video tag. </video> |

#### Example 3: Kicking
| **Our Model**    | **Reference**    | **Interpolation** |
|------------------|------------------|--------------------|
| <video width="200" controls> <source src="media_readme/our_model/1067.mp4" type="video/mp4"> Your browser does not support the video tag. </video> | <video width="200" controls> <source src="media_readme/original/1067.mp4" type="video/mp4"> Your browser does not support the video tag. </video> | <video width="200" controls> <source src="media_readme/interp/1067.mp4" type="video/mp4"> Your browser does not support the video tag. </video> |

### How to Run
:warning: This part will be updated soon! :warning: